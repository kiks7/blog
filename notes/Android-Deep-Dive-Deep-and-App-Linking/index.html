<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content="Introduction In the previous blog post we have covered some internal parts of the codebase that are involved in the intent registration and resolution process."><title>Android Deep Dive - Deep and App Linking</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=image/png href=https://1day.dev//icon.png><link href=https://1day.dev/styles.7153093e4d1bbb584a28469cadfa3f88.min.css rel=stylesheet><link href=https://1day.dev/styles/_light_syntax.86a48a52faebeaaf42158b72922b1c90.min.css rel=stylesheet id=theme-link><script src=https://1day.dev/js/darkmode.e6934a61ff52b65bd16cdf94b370f112.min.js></script>
<script src=https://1day.dev/js/util.9825137f5e7825e8553c68ce39ac9e44.min.js></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css integrity=sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js integrity=sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/contrib/copy-tex.min.js integrity=sha384-ww/583aHhxWkz5DEVn6OKtNiIaLi2iBRNZXfJRiY1Ai7tnJ9UXpEsyvOITVpTl4A crossorigin=anonymous></script>
<script src=https://unpkg.com/@floating-ui/core@0.7.3></script>
<script src=https://unpkg.com/@floating-ui/dom@0.5.4></script>
<script src=https://1day.dev/js/popover.53ad9a087e3feeaaa12b63bfd02d923b.min.js></script>
<script src=https://1day.dev/js/code-title.b35124ad8db0ba37162b886afb711cbc.min.js></script>
<script src=https://1day.dev/js/clipboard.c20857734e53a3fb733b7443879efa61.min.js></script>
<script src=https://1day.dev/js/callouts.7723cac461d613d118ee8bb8216b9838.min.js></script>
<script>const BASE_URL="https://1day.dev/",fetchData=Promise.all([fetch("https://1day.dev/indices/linkIndex.5754bb68ae367a7b3ab4836c63c29660.min.json").then(e=>e.json()).then(e=>({index:e.index,links:e.links})),fetch("https://1day.dev/indices/contentIndex.f05b550aaddbd50fba41d1cdac287c77.min.json").then(e=>e.json())]).then(([{index:e,links:t},n])=>({index:e,links:t,content:n})),render=()=>{const e=new URL(BASE_URL),t=e.pathname,n=window.location.pathname,s=t==n;addCopyButtons(),addTitleToCodeBlocks(),addCollapsibleCallouts(),initPopover("https://1day.dev",!1,!0)},init=(e=document)=>{addCopyButtons(),addTitleToCodeBlocks(),renderMathInElement(e.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],macros:{'â€™':"'"},throwOnError:!1})}</script><script type=module>
    import { attachSPARouting } from "https:\/\/1day.dev\/js\/router.9d4974281069e9ebb189f642ae1e3ca2.min.js"
    attachSPARouting(init, render)
  </script></head><script async src="https://www.googletagmanager.com/gtag/js?id=G-BZ6HJYMG3K"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-BZ6HJYMG3K",{anonymize_ip:!1})}</script><body><div id=search-container><div id=search-space><input autocomplete=off id=search-bar name=search type=text aria-label=Search placeholder="Search for something..."><div id=results-container></div></div></div><script src=https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js integrity="sha256-i3A0NZGkhsKjVMzFxv3ksk0DZh3aXqu0l49Bbh0MdjE=" crossorigin=anonymous defer></script>
<script defer src=https://1day.dev/js/full-text-search.24827f874defbbc6d529926cbfcfb493.min.js></script><div class=singlePage><header><h1 id=page-title><a href=https://1day.dev/>ðŸ‘¾ @kiks</a></h1><div class=spacer></div><div id=search-icon><p>Search</p><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg></div><div class=darkmode><input class=toggle id=darkmode-toggle type=checkbox tabindex=-1>
<label id=toggle-label-light for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="dayIcon" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35"><title>Light Mode</title><path d="M6 17.5C6 16.672 5.328 16 4.5 16h-3C.672 16 0 16.672.0 17.5S.672 19 1.5 19h3C5.328 19 6 18.328 6 17.5zM7.5 26c-.414.0-.789.168-1.061.439l-2 2C4.168 28.711 4 29.086 4 29.5 4 30.328 4.671 31 5.5 31c.414.0.789-.168 1.06-.44l2-2C8.832 28.289 9 27.914 9 27.5 9 26.672 8.329 26 7.5 26zm10-20C18.329 6 19 5.328 19 4.5v-3C19 .672 18.329.0 17.5.0S16 .672 16 1.5v3C16 5.328 16.671 6 17.5 6zm10 3c.414.0.789-.168 1.06-.439l2-2C30.832 6.289 31 5.914 31 5.5 31 4.672 30.329 4 29.5 4c-.414.0-.789.168-1.061.44l-2 2C26.168 6.711 26 7.086 26 7.5 26 8.328 26.671 9 27.5 9zM6.439 8.561C6.711 8.832 7.086 9 7.5 9 8.328 9 9 8.328 9 7.5c0-.414-.168-.789-.439-1.061l-2-2C6.289 4.168 5.914 4 5.5 4 4.672 4 4 4.672 4 5.5c0 .414.168.789.439 1.06l2 2.001zM33.5 16h-3c-.828.0-1.5.672-1.5 1.5s.672 1.5 1.5 1.5h3c.828.0 1.5-.672 1.5-1.5S34.328 16 33.5 16zM28.561 26.439C28.289 26.168 27.914 26 27.5 26c-.828.0-1.5.672-1.5 1.5.0.414.168.789.439 1.06l2 2C28.711 30.832 29.086 31 29.5 31c.828.0 1.5-.672 1.5-1.5.0-.414-.168-.789-.439-1.061l-2-2zM17.5 29c-.829.0-1.5.672-1.5 1.5v3c0 .828.671 1.5 1.5 1.5s1.5-.672 1.5-1.5v-3C19 29.672 18.329 29 17.5 29zm0-22C11.71 7 7 11.71 7 17.5S11.71 28 17.5 28 28 23.29 28 17.5 23.29 7 17.5 7zm0 18c-4.136.0-7.5-3.364-7.5-7.5s3.364-7.5 7.5-7.5 7.5 3.364 7.5 7.5S21.636 25 17.5 25z"/></svg></label><label id=toggle-label-dark for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="nightIcon" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'"><title>Dark Mode</title><path d="M96.76 66.458c-.853-.852-2.15-1.064-3.23-.534-6.063 2.991-12.858 4.571-19.655 4.571C62.022 70.495 50.88 65.88 42.5 57.5 29.043 44.043 25.658 23.536 34.076 6.47c.532-1.08.318-2.379-.534-3.23-.851-.852-2.15-1.064-3.23-.534-4.918 2.427-9.375 5.619-13.246 9.491-9.447 9.447-14.65 22.008-14.65 35.369.0 13.36 5.203 25.921 14.65 35.368s22.008 14.65 35.368 14.65c13.361.0 25.921-5.203 35.369-14.65 3.872-3.871 7.064-8.328 9.491-13.246C97.826 68.608 97.611 67.309 96.76 66.458z"/></svg></label></div></header><article><h1>Android Deep Dive - Deep and App Linking</h1><p class=meta>Last updated
Feb 21, 2025</p><ul class=tags><li><a href=https://1day.dev/tags/Android/>Android</a></li><li><a href=https://1day.dev/tags/Reversing/>Reversing</a></li></ul><aside class=mainTOC><details><summary>Table of Contents</summary><nav id=TableOfContents><ol><li><a href=#introduction>Introduction</a></li><li><a href=#deep-link>Deep Link</a><ol><li><a href=#actions-and-categories>Actions and Categories</a></li><li><a href=#intent-and-parse_uri><code>intent://</code> and <code>parse_uri</code></a></li></ol></li><li><a href=#app-link>App Link</a></li><li><a href=#browser-perspective>Browser perspective</a></li><li><a href=#linkify>Linkify</a></li><li><a href=#fragment-deeplinks>Fragment Deeplinks</a></li><li><a href=#conclusion>Conclusion</a></li><li><a href=#references>References</a></li></ol></nav></details></aside><a href=#introduction><h2 id=introduction><span class=hanchor arialabel=Anchor># </span>Introduction</h2></a><p>In the
<a href=https://1day.dev/notes/Android-Deep-Dive-Implicit-Intents/ rel=noopener>previous blog post</a> we have covered some internal parts of the codebase that are involved in the intent registration and resolution process. In this one we are going to deepen Deep and App Link resolutions in the Android Operating System and its remote Attack Surface. Deep and App Links are data components that permit to associate a specific link to a specific app component. In order to further detail their usage across the Android system, let&rsquo;s start with a Deep Link introduction.</p><a href=#deep-link><h2 id=deep-link><span class=hanchor arialabel=Anchor># </span>Deep Link</h2></a><p>Suppose that you are an app developer and you want to make some of your android app components reachable from an external source (e.g. a browser or another application), and you want an &ldquo;universal&rdquo; and standard solution: that&rsquo;s where Deep Links come in place! For example, you can have a link like <code>privateapp://app/login?username=user</code> that can be called anywhere (almost) and leads to your application execution logic. Moreover, you have a standard approach that you can use to register an arbitrary schema, host and path and you can also pass and receive parameters like a classic web URL. Deep Links are declared in the <code>AndroidManifest.xml</code> application file with an <code>&lt;intent-filter></code> declaration inside the targeted component (that can be an activity, service, receiver or provider). The following declaration can match the previously mentioned example:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;activity</span> <span class=na>android:name=</span><span class=s>&#34;.TargetLoginActivity&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;intent-filter&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;action</span> <span class=na>android:name=</span><span class=s>&#34;android.intent.action.VIEW&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;category</span> <span class=na>android:name=</span><span class=s>&#34;android.intent.category.DEFAULT&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;category</span> <span class=na>android:name=</span><span class=s>&#34;android.intent.category.BROWSABLE&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;data</span> <span class=na>android:scheme=</span><span class=s>&#34;privateapp&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;data</span> <span class=na>android:host=</span><span class=s>&#34;app&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;data</span> <span class=na>android:path=</span><span class=s>&#34;login&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;/intent-filter&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/activity&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>As can be seen the <code>android:scheme</code>, <code>android:host</code> and <code>android:path</code> attributes (more attributes can be found in the
<a href=https://developer.android.com/guide/topics/manifest/data-element rel=noopener>documentation</a>) of the <code>&lt;data></code> tag are used to register the specific URI to handle. Another common approach is to use a single <code>&lt;data></code> tag, but seems discouraged from the official documentation:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;activity</span> <span class=na>android:name=</span><span class=s>&#34;.TargetLoginActivity&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;intent-filter&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;action</span> <span class=na>android:name=</span><span class=s>&#34;android.intent.action.VIEW&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;category</span> <span class=na>android:name=</span><span class=s>&#34;android.intent.category.DEFAULT&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;category</span> <span class=na>android:name=</span><span class=s>&#34;android.intent.category.BROWSABLE&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;data</span> <span class=na>android:scheme=</span><span class=s>&#34;privateapp&#34;</span>
</span></span><span class=line><span class=cl>			<span class=na>android:host=</span><span class=s>&#34;app&#34;</span>
</span></span><span class=line><span class=cl>			<span class=na>android:path=</span><span class=s>&#34;login&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;/intent-filter&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/activity&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>The internal classification, as explained in the previous blog post, is of type <code>Schemes</code> but can also contains some MIME types and fall inside other categorizations too (that can be enumerated with <code>dumpsys package</code>).</p><a href=#actions-and-categories><h3 id=actions-and-categories><span class=hanchor arialabel=Anchor># </span>Actions and Categories</h3></a><p>An important aspect of a Deep Link reachability is the declared actions and categories. Not all deep links are intended to be reachable from anywhere but an interesting behaviour is that the link can dropped &ldquo;anywhere&rdquo; (e.g. in a browser inside the <code>&lt;a></code> element) and a click into it will results into an <strong>implicit intent</strong> sent from the browser to the android system, that will take care of the resolution to the appropriate destination (as explained in the first article). For that reason, actions and categories have a fundamental role:</p><ul><li><a href=https://developer.android.com/reference/android/content/Intent#ACTION_VIEW rel=noopener><code>ACTION_VIEW</code></a>: The VIEW action is the default action that is sent if a link is clicked from an <code>&lt;a></code> element or a button from web page. It is useful to be specified inside the <code>intent-filter</code> declaration if the intention is to reach the link from a simple click.</li><li><a href=https://developer.android.com/reference/android/content/Intent#CATEGORY_BROWSABLE rel=noopener><code>CATEGORY_BROWSABLE</code></a>: The BROWSABLE category is necessary to reach the intent from a web browser (e.g. chrome). When a browser interacts with the <code>ActivityManager</code> system service, it asks for the resolution of the desired deep link by also specifying the required <code>CATEGORY_BROWSABLE</code> category in the requested <code>intent</code> parameter (the second parameter of the <code>IntentResolver::queryIntent</code> method). If the targeted intent filter does not match that category, the resolution fails and never happen.</li><li><a href=https://developer.android.com/reference/android/content/Intent#CATEGORY_DEFAULT rel=noopener><code>CATEGORY_DEFAULT</code></a>: The DEFAULT category is necessary to the application to respond to implicit intents, as specified in the
<a href=https://developer.android.com/training/app-links/deep-linking rel=noopener>documentation</a>.</li></ul><p>While <code>BROWSABLE</code> and <code>DEFAULT</code> are mandatory for the implicit resolution process, the action is not that strictly necessary. The default <code>VIEW</code> action is meant for direct link access (e.g. <code>privateapp://app/login?username=user</code> inside an <code>&lt;a></code> element) but it&rsquo;s also possible to use the <code>intent://</code> approach.</p><a href=#intent-and-parse_uri><h3 id=intent-and-parse_uri><span class=hanchor arialabel=Anchor># </span><code>intent://</code> and <code>parse_uri</code></h3></a><p>Browsers with android support (e.g. google chrome) can use a special syntax: <code>intent://</code>. This syntax, that can be used in a web page as a normal link, permits to launch android app components (that match the <code>BROWSABLE</code> and <code>DEFAULT</code> categories) directly from a web browser, just like a simpler direct deep link. The
<a href=https://developer.chrome.com/docs/android/intents rel=noopener>chrome documentation</a> details it and uses the following as an URI template:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nl>intent:</span>  
</span></span><span class=line><span class=cl>   <span class=n>HOST</span><span class=o>/</span><span class=n>URI</span><span class=o>-</span><span class=n>path</span> <span class=c1>// Optional host  
</span></span></span><span class=line><span class=cl><span class=c1></span>   <span class=err>#</span><span class=n>Intent</span><span class=o>;</span>  
</span></span><span class=line><span class=cl>      <span class=n>package</span><span class=o>=</span><span class=err>\</span><span class=o>[</span><span class=n>string</span><span class=err>\</span><span class=o>];</span>  
</span></span><span class=line><span class=cl>      <span class=n>action</span><span class=o>=</span><span class=err>\</span><span class=o>[</span><span class=n>string</span><span class=err>\</span><span class=o>];</span>  
</span></span><span class=line><span class=cl>      <span class=n>category</span><span class=o>=</span><span class=err>\</span><span class=o>[</span><span class=n>string</span><span class=err>\</span><span class=o>];</span>  
</span></span><span class=line><span class=cl>      <span class=n>component</span><span class=o>=</span><span class=err>\</span><span class=o>[</span><span class=n>string</span><span class=err>\</span><span class=o>];</span>  
</span></span><span class=line><span class=cl>      <span class=n>scheme</span><span class=o>=</span><span class=err>\</span><span class=o>[</span><span class=n>string</span><span class=err>\</span><span class=o>];</span>  
</span></span><span class=line><span class=cl>   <span class=n>end</span><span class=o>;</span>
</span></span></code></pre></td></tr></table></div></div><p>For example, the previous <code>privateapp://app/login?username=user</code> can be <code>intent://app/login#Intent;scheme=privateapp;end</code> and perform the same operation. However, one of the main difference is the required action. While a direct deep link requires the target component to have the <code>ACTION_VIEW</code> declared and can only trigger that action, the <code>intent://</code> scheme permits to call arbitrary actions based on the <code>action</code> parameter. For example, the intent <code>intent://app/login#Intent;scheme=privateapp;action=android.action.ARBITRARY_ACT;end</code> launches the same intent but with the action <code>android.action.ARBITRARY_ACT</code> instead of the default VIEW one. The logic behind this intent creation from an URI can be found in the
<a href="https://cs.android.com/android/platform/superproject/+/android-14.0.0_r37:frameworks/base/core/java/android/content/Intent.java;l=7921" rel=noopener><code>Intent::parseUri</code></a> method and, as can be seen from the source code, it is possible to specify different options like categories, target package name, extras, data and so on.</p><a href=#app-link><h2 id=app-link><span class=hanchor arialabel=Anchor># </span>App Link</h2></a><p>App Links are the same as Deep Links but with a major difference: they are associated with a domain. Instead of the <code>privateapp://app/login?username=user</code> we can have <code>https://mypersonal.website.com/login?username=user</code> that is entirely the same as a classic URL that can be navigated from a web browser but, if the application is installed and the intent filter registered, it permits to continue the navigation to the mobile application, with a better user experience from a mobile point of view. So, an App Link declaration can looks like this:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;activity</span> <span class=na>android:name=</span><span class=s>&#34;.TargetLoginActivity&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;intent-filter</span> <span class=na>autoVerify=</span><span class=s>&#34;true&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;action</span> <span class=na>android:name=</span><span class=s>&#34;android.intent.action.VIEW&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;category</span> <span class=na>android:name=</span><span class=s>&#34;android.intent.category.DEFAULT&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;category</span> <span class=na>android:name=</span><span class=s>&#34;android.intent.category.BROWSABLE&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;data</span> <span class=na>android:scheme=</span><span class=s>&#34;https&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;data</span> <span class=na>android:host=</span><span class=s>&#34;mypersonal.website.com&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>		<span class=nt>&lt;data</span> <span class=na>android:path=</span><span class=s>&#34;login&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;/intent-filter&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/activity&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>Similar to the previously described deep link but with one crucial difference: the <code>android:scheme</code> is either <code>http</code> or <code>https</code>. In order to associate a specific application to an arbitrary domain, a verification through the
<a href=https://developers.google.com/digital-asset-links rel=noopener>Digital Asset Links</a> is required. Without this verification, the App Link is not trusted and it is not possible to use it. An <code>assetlinks.json</code> must be created for that purpose in the target domain, as well explained in the
<a href=https://developer.android.com/training/app-links/verify-android-applinks rel=noopener>Verify Android App Links</a> documentation. For debugging purposes, it is possible to verify App Links through <code>adb shell pm set-app-links --package com.app.example 1 all</code> and verify its validation with <code>adb shell pm get-app-links com.app.example</code> (the constant should be <code>1</code> to be verified).</p><a href=#browser-perspective><h2 id=browser-perspective><span class=hanchor arialabel=Anchor># </span>Browser perspective</h2></a><p>From a browser perspective (e.g. chrome in this overview), intents delivered through deep and app links are requested to a preliminary call to the IPC method <code>queryIntentActivities</code> of the <code>PackageManager</code> service. If an intent matches, with all requested attributes and the <code>BROWSABLE</code> category, the intent is delivered using <code>startActivity</code> from the <code>ActivityTaskManager</code> system service. Since the intent matching is performed with <code>queryIntentActivities</code>, resolved components can be only activities.</p><a href=#linkify><h2 id=linkify><span class=hanchor arialabel=Anchor># </span>Linkify</h2></a><p>An interesting android class related to Deep and App Links is
<a href=https://developer.android.com/reference/android/text/util/Linkify rel=noopener><code>Linkify</code></a>: it uses regular expressions to transform a piece of text into clickable links.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>textView</span><span class=o>.</span><span class=na>setText</span><span class=o>(</span><span class=s>&#34;Contat us at info@mail.com or call +1234567890&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>Linkify</span><span class=o>.</span><span class=na>addLinks</span><span class=o>(</span><span class=n>textView</span><span class=o>,</span> <span class=n>Linkify</span><span class=o>.</span><span class=na>EMAIL_ADDRESSES</span> <span class=o>|</span> <span class=n>Linkify</span><span class=o>.</span><span class=na>PHONE_NUMBERS</span><span class=o>);</span>
</span></span></code></pre></td></tr></table></div></div><p>The &ldquo;linkified&rdquo; version of the provided text will generates two clickable links: the e-mail and the phone number. They are both replaced with the system deep link default handler (e.g. <code>mailto://</code> and <code>tel:</code> for the phone number) in order to send an implicit intent with that scheme. It is possible, in Android 14, to linkify web urls, e-mail addresses, phone numbers and map addresses. The Linkify code is at
<a href="https://cs.android.com/android/platform/superproject/main/+/main:frameworks/base/core/java/android/text/util/Linkify.java;l=99;drc=a78d762ccdbcb1f8f40f2c860caca75ade5d486b" rel=noopener><code>Linkify.java</code></a> file and represent an interesting behaviour that can be used and abused from third-party apps (e.g. messaging apps).</p><a href=#fragment-deeplinks><h2 id=fragment-deeplinks><span class=hanchor arialabel=Anchor># </span>Fragment Deeplinks</h2></a><p>Fragments are commonly used as portions in the Android UI and can be linked to Deep and App Links also if they cannot be exported as normal components. The process of creating a deep link for a fragment is described in the
<a href=https://developer.android.com/guide/navigation/design/deep-link rel=noopener>Android documentation</a> and the main logic is that a &ldquo;fragment navigation&rdquo; resource XML file is created and linked to a specific activity through the <code>&lt;nav-graph></code> element:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=cp>&lt;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;?&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;manifest</span> <span class=na>xmlns:android=</span><span class=s>&#34;http://schemas.android.com/apk/res/android&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>package=</span><span class=s>&#34;com.example.myapplication&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;application</span> <span class=err>...</span> <span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;activity</span> <span class=na>name=</span><span class=s>&#34;.MainActivity&#34;</span> <span class=err>...</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;nav-graph</span> <span class=na>android:value=</span><span class=s>&#34;res/nav_graph.xml&#34;</span> <span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;/activity&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/application&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/manifest&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>The <code>res/nav_graph.xml</code> contains a Deep Link declaration that is tied to a specific fragment and follows the usual Deep and App link declaration style:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;fragment</span> <span class=na>android:id=</span><span class=s>&#34;@+id/a&#34;</span>
</span></span><span class=line><span class=cl>          <span class=na>android:name=</span><span class=s>&#34;com.example.myapplication.FragmentA&#34;</span>
</span></span><span class=line><span class=cl>          <span class=na>tools:layout=</span><span class=s>&#34;@layout/a&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;deepLink</span> <span class=na>app:uri=</span><span class=s>&#34;www.example.com&#34;</span>
</span></span><span class=line><span class=cl>                <span class=na>app:action=</span><span class=s>&#34;android.intent.action.MY_ACTION&#34;</span>
</span></span><span class=line><span class=cl>                <span class=na>app:mimeType=</span><span class=s>&#34;type/subtype&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/fragment&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>However, they key part is that the <code>&lt;deepLink></code> element, at build time, is transformed into a classic <code>&lt;intent-filter></code> of the activity that holds the <code>&lt;nav-graph></code> declaration (with the appropriate action and categories). That means that, when the application is compiled, the <code>&lt;intent-filter></code> declaration is the same of a &ldquo;classic&rdquo; one.</p><a href=#conclusion><h2 id=conclusion><span class=hanchor arialabel=Anchor># </span>Conclusion</h2></a><p>In this two part series we have covered intent implicit resolution, deep linking and the browser perspective. While assessing the Attack Surface of an Android mobile application, it is crucial to have a solid understanding of these key internal concepts and components.</p><a href=#references><h2 id=references><span class=hanchor arialabel=Anchor># </span>References</h2></a><ul><li><a href=https://developer.android.com/guide/topics/manifest/data-element rel=noopener>https://developer.android.com/guide/topics/manifest/data-element</a></li><li><a href=https://developer.android.com/training/app-links/deep-linking rel=noopener>https://developer.android.com/training/app-links/deep-linking</a></li><li><a href=https://developer.chrome.com/docs/android/intents rel=noopener>https://developer.chrome.com/docs/android/intents</a></li><li><a href=https://developer.android.com/guide/navigation/design/deep-link rel=noopener>https://developer.android.com/guide/navigation/design/deep-link</a></li></ul></article><hr><div id=contact_buttons><footer><p>Powered by <a href=https://github.com/jackyzha0/quartz>Quartz</a>, Â© 2025</p><ul><li><a href=https://1day.dev/>Home</a></li><li><a href=https://twitter.com/kiks7_7>Twitter</a></li><li><a href=https://github.com/kiks7>Github</a></li><li><a href=https://linkedin.com/in/alessandro-groppo-1a0429146>Linkedin</a></li></ul></footer></div></div></body></html>