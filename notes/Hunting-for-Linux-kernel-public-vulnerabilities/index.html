<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content="Introduction Recently was looking for a vulnerability that permitted me to practise what I&rsquo;ve learned during the last few months on Linux Kernel Exploitation with a &ldquo;real-life&rdquo; scenario."><title>Hunting for Linux kernel public vulnerabilities</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=image/png href=https://1day.dev//icon.png><link href=https://1day.dev/styles.7153093e4d1bbb584a28469cadfa3f88.min.css rel=stylesheet><link href=https://1day.dev/styles/_light_syntax.86a48a52faebeaaf42158b72922b1c90.min.css rel=stylesheet id=theme-link><script src=https://1day.dev/js/darkmode.e6934a61ff52b65bd16cdf94b370f112.min.js></script>
<script src=https://1day.dev/js/util.9825137f5e7825e8553c68ce39ac9e44.min.js></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css integrity=sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js integrity=sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/contrib/copy-tex.min.js integrity=sha384-ww/583aHhxWkz5DEVn6OKtNiIaLi2iBRNZXfJRiY1Ai7tnJ9UXpEsyvOITVpTl4A crossorigin=anonymous></script>
<script src=https://unpkg.com/@floating-ui/core@0.7.3></script>
<script src=https://unpkg.com/@floating-ui/dom@0.5.4></script>
<script src=https://1day.dev/js/popover.53ad9a087e3feeaaa12b63bfd02d923b.min.js></script>
<script src=https://1day.dev/js/code-title.b35124ad8db0ba37162b886afb711cbc.min.js></script>
<script src=https://1day.dev/js/clipboard.c20857734e53a3fb733b7443879efa61.min.js></script>
<script src=https://1day.dev/js/callouts.7723cac461d613d118ee8bb8216b9838.min.js></script>
<script>const BASE_URL="https://1day.dev/",fetchData=Promise.all([fetch("https://1day.dev/indices/linkIndex.ac82e8decb8dc8a597c857b3650a94a1.min.json").then(e=>e.json()).then(e=>({index:e.index,links:e.links})),fetch("https://1day.dev/indices/contentIndex.f2cf86d51427d0ee368981c57e7bb3a8.min.json").then(e=>e.json())]).then(([{index:e,links:t},n])=>({index:e,links:t,content:n})),render=()=>{const e=new URL(BASE_URL),t=e.pathname,n=window.location.pathname,s=t==n;addCopyButtons(),addTitleToCodeBlocks(),addCollapsibleCallouts(),initPopover("https://1day.dev",!1,!0);const o=document.getElementById("footer");if(o){const e=document.getElementById("graph-container");if(!e)return requestAnimationFrame(render);e.textContent="";const t=s&&!1;drawGraph("https://1day.dev",t,[{"/moc":"#4388cc"}],t?{centerForce:1,depth:-1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.5,linkDistance:1,opacityScale:3,repelForce:1,scale:1.4}:{centerForce:1,depth:1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.6,linkDistance:1,opacityScale:3,repelForce:2,scale:1.2})}},init=(e=document)=>{addCopyButtons(),addTitleToCodeBlocks(),renderMathInElement(e.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],macros:{'â€™':"'"},throwOnError:!1})}</script><script type=module>
    import { attachSPARouting } from "https:\/\/1day.dev\/js\/router.9d4974281069e9ebb189f642ae1e3ca2.min.js"
    attachSPARouting(init, render)
  </script></head><script async src="https://www.googletagmanager.com/gtag/js?id=G-BZ6HJYMG3K"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-BZ6HJYMG3K",{anonymize_ip:!1})}</script><body><div id=search-container><div id=search-space><input autocomplete=off id=search-bar name=search type=text aria-label=Search placeholder="Search for something..."><div id=results-container></div></div></div><script src=https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js integrity="sha256-i3A0NZGkhsKjVMzFxv3ksk0DZh3aXqu0l49Bbh0MdjE=" crossorigin=anonymous defer></script>
<script defer src=https://1day.dev/js/full-text-search.24827f874defbbc6d529926cbfcfb493.min.js></script><div class=singlePage><header><h1 id=page-title><a href=https://1day.dev/>ðŸ‘¾ @kiks</a></h1><div class=spacer></div><div id=search-icon><p>Search</p><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg></div><div class=darkmode><input class=toggle id=darkmode-toggle type=checkbox tabindex=-1>
<label id=toggle-label-light for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="dayIcon" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35"><title>Light Mode</title><path d="M6 17.5C6 16.672 5.328 16 4.5 16h-3C.672 16 0 16.672.0 17.5S.672 19 1.5 19h3C5.328 19 6 18.328 6 17.5zM7.5 26c-.414.0-.789.168-1.061.439l-2 2C4.168 28.711 4 29.086 4 29.5 4 30.328 4.671 31 5.5 31c.414.0.789-.168 1.06-.44l2-2C8.832 28.289 9 27.914 9 27.5 9 26.672 8.329 26 7.5 26zm10-20C18.329 6 19 5.328 19 4.5v-3C19 .672 18.329.0 17.5.0S16 .672 16 1.5v3C16 5.328 16.671 6 17.5 6zm10 3c.414.0.789-.168 1.06-.439l2-2C30.832 6.289 31 5.914 31 5.5 31 4.672 30.329 4 29.5 4c-.414.0-.789.168-1.061.44l-2 2C26.168 6.711 26 7.086 26 7.5 26 8.328 26.671 9 27.5 9zM6.439 8.561C6.711 8.832 7.086 9 7.5 9 8.328 9 9 8.328 9 7.5c0-.414-.168-.789-.439-1.061l-2-2C6.289 4.168 5.914 4 5.5 4 4.672 4 4 4.672 4 5.5c0 .414.168.789.439 1.06l2 2.001zM33.5 16h-3c-.828.0-1.5.672-1.5 1.5s.672 1.5 1.5 1.5h3c.828.0 1.5-.672 1.5-1.5S34.328 16 33.5 16zM28.561 26.439C28.289 26.168 27.914 26 27.5 26c-.828.0-1.5.672-1.5 1.5.0.414.168.789.439 1.06l2 2C28.711 30.832 29.086 31 29.5 31c.828.0 1.5-.672 1.5-1.5.0-.414-.168-.789-.439-1.061l-2-2zM17.5 29c-.829.0-1.5.672-1.5 1.5v3c0 .828.671 1.5 1.5 1.5s1.5-.672 1.5-1.5v-3C19 29.672 18.329 29 17.5 29zm0-22C11.71 7 7 11.71 7 17.5S11.71 28 17.5 28 28 23.29 28 17.5 23.29 7 17.5 7zm0 18c-4.136.0-7.5-3.364-7.5-7.5s3.364-7.5 7.5-7.5 7.5 3.364 7.5 7.5S21.636 25 17.5 25z"/></svg></label><label id=toggle-label-dark for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="nightIcon" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'"><title>Dark Mode</title><path d="M96.76 66.458c-.853-.852-2.15-1.064-3.23-.534-6.063 2.991-12.858 4.571-19.655 4.571C62.022 70.495 50.88 65.88 42.5 57.5 29.043 44.043 25.658 23.536 34.076 6.47c.532-1.08.318-2.379-.534-3.23-.851-.852-2.15-1.064-3.23-.534-4.918 2.427-9.375 5.619-13.246 9.491-9.447 9.447-14.65 22.008-14.65 35.369.0 13.36 5.203 25.921 14.65 35.368s22.008 14.65 35.368 14.65c13.361.0 25.921-5.203 35.369-14.65 3.872-3.871 7.064-8.328 9.491-13.246C97.826 68.608 97.611 67.309 96.76 66.458z"/></svg></label></div></header><article><h1>Hunting for Linux kernel public vulnerabilities</h1><p class=meta>Last updated
Jun 6, 2022</p><ul class=tags><li><a href=https://1day.dev/tags/Exploitation/>Exploitation</a></li><li><a href=https://1day.dev/tags/Linux/>Linux</a></li><li><a href=https://1day.dev/tags/Kernel/>Kernel</a></li></ul><aside class=mainTOC><details><summary>Table of Contents</summary><nav id=TableOfContents><ol><li><a href=#introduction>Introduction</a></li><li><a href=#tldr>TL;DR</a></li><li><a href=#public-bugs>Public bugs</a><ol><li><a href=#bugzilla>BugZilla</a></li><li><a href=#syzbot>Syzbot</a></li><li><a href=#changelogs>Changelogs</a></li><li><a href=#git-log>Git log</a></li></ol></li><li><a href=#personal-experience>Personal Experience</a></li><li><a href=#conclusion>Conclusion</a></li><li><a href=#references>References</a></li></ol></nav></details></aside><a href=#introduction><h2 id=introduction><span class=hanchor arialabel=Anchor># </span>Introduction</h2></a><p>Recently was looking for a vulnerability that permitted me to practise what I&rsquo;ve learned during the last few months on Linux Kernel Exploitation with a &ldquo;real-life&rdquo; scenario. Since I had a week to dedicate my time in Hacktive Security to deepen a specific argument, I decided to search for a public vulnerability without a public exploit to develop it by myself. The next blog post will be related to the development of that 1day, this one is a quick post about how I discovered and choose the vulnerability using online sources, since I didn&rsquo;t found anything similar online.</p><a href=#tldr><h2 id=tldr><span class=hanchor arialabel=Anchor># </span>TL;DR</h2></a><p>This blog post is about public resourses to identify known vulnerabilities in the Linux Kernel in order to practise some Kernel Exploitation in a real-life scenario. These resources includes: BugZilla, SyzBot, changelogs and git logs.</p><a href=#public-bugs><h2 id=public-bugs><span class=hanchor arialabel=Anchor># </span>Public bugs</h2></a><p>The first thing I asked myself was: how do I find a suitable bug for my purpose? I excluded searching it by CVE since not all vulnerabilities have an assigned CVE (and usually they are the most &ldquo;famous&rdquo; ones) and that&rsquo;s when I used the most powerful hacking skill: googling. That led me to various resources that I would like to share today starting by saying that that&rsquo;s only the result of my personal work that could not reflect the best way to perform the same job. That said, this is what I&rsquo;ve used to find my &ldquo;matched&rdquo; Nday:</p><ul><li>Bugzilla</li><li>SyzBot</li><li>Changelogs</li><li>Git log</li></ul><p>Kernel changelogs is definitely my favourite one but let&rsquo;s say few words on all of them.</p><a href=#bugzilla><h3 id=bugzilla><span class=hanchor arialabel=Anchor># </span>BugZilla</h3></a><p><a href=https://bugzilla.kernel.org/ rel=noopener>BugZilla</a> is the standard way to
<a href=https://www.kernel.org/doc/html/v4.19/admin-guide/reporting-bugs.html rel=noopener>report bugs</a> in the upstream Linux kernels. You can find interesting vulnerabilities organised by subsystem (e.g. Networking with IPv4 and IPv6 or file system with ext* types and so on) and you can also search for keywords (such as &ldquo;overflow&rdquo;, &ldquo;heap&rdquo;, &ldquo;UAF&rdquo; and so on ..) using the standard search or the more advanced one. The personal downside is the mix of a lot of &ldquo;non vulnerabilities&rdquo;, hangs and stuff like that. Also, you do not have the most powerful search options (e.g. some bash). However, it is still a good option and I personally pinned few vulnerabilities that i excluded afterwards.</p><a href=#syzbot><h3 id=syzbot><span class=hanchor arialabel=Anchor># </span>Syzbot</h3></a><p>&ldquo;syzbot is a continuous fuzzing/reporting system based on syzkaller fuzzer&rdquo;
<a href=https://lwn.net/Articles/749910/ rel=noopener>source</a>.<br>Not the best GUI but at least you can have a lot of potentially open and fixed vulnerabilties. There isn&rsquo;t a built-in search option but you can use your browser&rsquo;s one or parse the HTML with an HTML parser. One of the downside, beyond the lack of searching, is the presence of tons of false-positives (in the &ldquo;Open section&rdquo;). However, upsides are pretty good: you can find open vulnerabilites (still not fixed), reproducers (C or syzlang), fixed commits and reported issues have the syzkaller nomenclature that is pretty self-explainationary.</p><a href=#syzkaller-bugs-google-group><h4 id=syzkaller-bugs-google-group><span class=hanchor arialabel=Anchor># </span>Syzkaller-bugs (Google Group)</h4></a><p>The lack of a search functionality in syz-bot is well replaced by the
<a href=https://groups.google.com/g/syzkaller-bugs/ rel=noopener>&ldquo;syzkaller-bugs&rdquo; Google Group</a> from where you can find syz-bot reported bugs with additional information from the comment section and an enanched search bar. I really enjoy this option !</p><a href=#changelogs><h3 id=changelogs><span class=hanchor arialabel=Anchor># </span>Changelogs</h3></a><p>That&rsquo;s my favourite method: download all changelogs from the
<a href=https://cdn.kernel.org/pub/linux/kernel/VERSION/ rel=noopener>kernel CDN</a> of your desired kernel version and you can enjoy all downloaded files with your favourite bash commands. This approach is similar to search from git commits but with the advantage that it is way faster. With some bash-fu, you can download all changelogs for a target kernel version (e.g. 4.x) with the following inline:Â <code>URL=https://cdn.kernel.org/pub/linux/kernel/v4.x/ && curl $URL | grep "ChangeLog-4.9" | grep -v '.sign' | cut -d "\"" -f 2 | while read line; do wget "$URL/$line"; done</code>.<br>Once all changelogs have been downloaded it&rsquo;s possible toÂ <code>grep</code>Â for juicy keywoards like UAF, OOB, overflow and so on. I found very useful to display text before and after the selected keyword, like:Â <code>grep -A5 -B5 UAF *</code>. In that way, you can instantly have quick information about vulnerability details, impacted subsystem, limitations, ..<br>For each identified vulnerability, it&rsquo;s possible to see its patch by diffing the patch commit with the previous one (linux source from git is needed):Â <code>git diff &lt;commit before> &lt;commit patch></code>.</p><a href=#git-log><h3 id=git-log><span class=hanchor arialabel=Anchor># </span>Git log</h3></a><p>As said before, this is a similar approach to the &ldquo;Changelogs&rdquo; method. The concept is pretty simple: clone the github repository and search for juicy keywoards in the commit history. You can do that with the following commands:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git clone git://git.kernel.org/pub/scm/linux/kernel/git/stable/linux-stable.git
</span></span><span class=line><span class=cl><span class=nb>cd</span> linux-stable
</span></span><span class=line><span class=cl>git checkout -f &lt;TAG -&gt; <span class=c1># e.g. git checkout -f v4.9.316 (from https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git)</span>
</span></span><span class=line><span class=cl>git log &gt; ../git.log
</span></span></code></pre></td></tr></table></div></div><p>In that way, you can do the same thing as before onÂ <code>git.log</code>Â file. The big downside, however, is that the file is too big and it takes more time (11.429.573 lines on 4.9.316). That&rsquo;s the reason why I prefer the &ldquo;Changelog&rdquo; method.</p><a href=#personal-experience><h2 id=personal-experience><span class=hanchor arialabel=Anchor># </span>Personal Experience</h2></a><p>I was searching for an Use-After-Free vulnerability and I started to search for it in all mentioned resources: BugZilla, SyzBot, Changelogs and git history. I wrote them down in a table with a resume description in order to further analyze them later on. I started to dig into few of them viewing their patch and source code in order to understand reachability, compile dependencies and exploitability. I strumbled into an interesting one: a vulnerability in the RAWMIDI interface (commit c13f1463d84b86bedb664e509838bef37e6ea317). I discovered it with the &ldquo;Changelog&rdquo; method, by searching for theÂ &ldquo;UAF&rdquo;Â keyword reading the previous and next five lines:Â <code>grep -A5 -B5 UAF *</code>. By seeing its behaviours, I was convinced to go with that vulnerability, an Use-After-Free triggered in a race condition.</p><a href=#conclusion><h2 id=conclusion><span class=hanchor arialabel=Anchor># </span>Conclusion</h2></a><p>I illustrated my experience on finding a public vulnerability to practise some linux kernel exploitation using public resources. The next blog post will be about the mentioned vulnerability in the RAWMIDI interface with all steps involved in the exploitation phase.</p><a href=#references><h2 id=references><span class=hanchor arialabel=Anchor># </span>References</h2></a><ul><li><a href=https://bugzilla.kernel.org/ rel=noopener>https://bugzilla.kernel.org/</a></li><li><a href=https://www.kernel.org/doc/html/v4.19/admin-guide/reporting-bugs.html rel=noopener>https://www.kernel.org/doc/html/v4.19/admin-guide/reporting-bugs.html</a></li><li><a href=https://lwn.net/Articles/749910/ rel=noopener>https://lwn.net/Articles/749910/</a></li><li><a href=https://groups.google.com/g/syzkaller-bugs/ rel=noopener>https://groups.google.com/g/syzkaller-bugs/</a></li><li><a href=https://cdn.kernel.org/pub/linux/kernel/VERSION/ rel=noopener>https://cdn.kernel.org/pub/linux/kernel/VERSION/</a></li></ul></article><hr><div class=page-end id=footer><div class=backlinks-container><h3>Backlinks</h3><ul class=backlinks><li>No backlinks found</li></ul></div><div><script src=https://cdn.jsdelivr.net/npm/d3@6.7.0/dist/d3.min.js integrity="sha256-+7jaYCp29O1JusNWHaYtgUn6EhuP0VaFuswhNV06MyI=" crossorigin=anonymous></script><h3>Interactive Graph</h3><div id=graph-container></div><style>:root{--g-node:var(--secondary);--g-node-active:var(--primary);--g-node-inactive:var(--visited);--g-link:var(--outlinegray);--g-link-active:#5a7282}</style><script src=https://1day.dev/js/graph.abd4bc2af3869a96524d7d23b76152c7.js></script></div></div><div id=contact_buttons><footer><p>Powered by <a href=https://github.com/jackyzha0/quartz>Quartz</a>, Â© 2025</p><ul><li><a href=https://1day.dev/>Home</a></li><li><a href=https://twitter.com/kiks7_7>Twitter</a></li><li><a href=https://github.com/kiks7>Github</a></li></ul></footer></div></div></body></html>